// Web3Auth Libraries
import { Web3AuthConnector } from '@web3auth/web3auth-wagmi-connector';
import { Web3Auth } from '@web3auth/modal';
import { OpenloginAdapter } from '@web3auth/openlogin-adapter';
import { TorusWalletConnectorPlugin } from '@web3auth/torus-wallet-connector-plugin';
import {
    clientIdTestnetWeb3Auth,
    chainConfigProd,
    clientIdProdWeb3Auth,
    chainConfigTestnet
} from '@config';
import { Chain } from '@wagmi/core';

export default function rainbowWeb3AuthConnector(chains: Chain[]) {
    // Create Web3Auth Instance
    const name = 'Cotry Club';
    const iconUrl = 'https://web3auth.io/docs/contents/logo-ethereum.png';
    const web3AuthInstance = new Web3Auth({
        clientId: clientIdTestnetWeb3Auth,
        chainConfig: chainConfigTestnet,
        uiConfig: {
            theme: 'dark',
            loginMethodsOrder: ['facebook', 'google'],
            defaultLanguage: 'en',
            appLogo: 'https://web3auth.io/images/w3a-L-Favicon-1.svg', // Your App Logo Here
            modalZIndex: '2147483647'
        }
    });

    // Add openlogin adapter for customisations
    const openloginAdapterInstance = new OpenloginAdapter({
        adapterSettings: {
            network: 'cyan',
            uxMode: 'popup',
            whiteLabel: {
                name: 'Cotry',
                logoLight: 'https://web3auth.io/images/w3a-L-Favicon-1.svg',
                logoDark: 'https://web3auth.io/images/w3a-D-Favicon-1.svg',
                defaultLanguage: 'en',
                dark: true // whether to enable dark mode. defaultValue: false
            }
        }
    });
    web3AuthInstance.configureAdapter(openloginAdapterInstance);

    // Add Torus Wallet Plugin
    const torusPlugin = new TorusWalletConnectorPlugin({
        torusWalletOpts: {
            buttonPosition: 'bottom-left'
        },
        walletInitOptions: {
            whiteLabel: {
                theme: { isDark: false, colors: { primary: '#00a8ff' } },
                logoDark: iconUrl,
                logoLight: iconUrl
            },
            useWalletConnect: true,
            enableLogging: true
        }
    });
    web3AuthInstance.addPlugin(torusPlugin);

    // return new Web3AuthConnector({
    //     chains: chainsData,
    //     options: {
    //         web3AuthInstance
    //     }
    // });

    return {
        id: 'web3auth',
        name,
        iconUrl,
        iconBackground: '#fff',
        createConnector: () => {
            const connector = new Web3AuthConnector({
                chains: chains,
                options: {
                    web3AuthInstance
                }
            });
            return {
                connector
            };
        }
    };
}
